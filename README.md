# pmgui
PATE Monitor UI code (Flask REST API + Web UI)

This application is intended for Foresail-1 PATE development and testing purposes, but the Web UI (and REST API it uses) can be recycled into mission time EGSE purposes, if the platform team so chooses.

## nginx Configuration
Site file '/etc/nginx/sites-available/default' (or which ever is relevant) needs to reflact uWSGI configuration.

    server {
        listen 80 default_server;
        listen [::]:80 default_server;
    
        root /srv/nginx-root;
        server_name _;
        location / {
            include uwsgi_params;
            uwsgi_pass unix:/tmp/patemon_app.sock;
        }
    }

Issue 'systemctl restart nginx' to apply changes

## Instance Configuration
This Flask application holds configuration information in '/srv/nginx-root/instance' directory.
Create this directory and 'pmapi.conf' file into it (0440 www-data.www-data):

    #! /usr/bin/env python3
    # -*- coding: utf-8 -*-
    #
    # Turku University (2018) Department of Future Technologies
    # Foresail-1 / PATE Monitor / Middleware (PMAPI)
    # Flask application configuration
    #
    # pmapi.conf - Jani Tammi <jasata@utu.fi>
    #
    #   0.1.0   2018.10.11  Initial version.
    #
    #
    # See http://flask.pocoo.org/docs/0.12/config/ for built-in config values.
    #
    # To generate SECRET_KEY:
    # >>> import os
    # >>> os.urandom(24)
    # b'\xb5R\x8d...
    #
    # Copy the generated bytes into SECRET_KEY
    import os
    
    DEBUG                    = True
    SESSION_COOKIE_NAME      = 'pmapisession'
    SECRET_KEY               = b'\xb5R...
    EXPLAIN_TEMPLATE_LOADING = True
    TOP_LEVEL_DIR            = os.path.abspath(os.curdir)
    BASEDIR                  = os.path.abspath(os.path.dirname(__file__))
    
    
    #
    # Flask app logging
    #
    LOG_FILENAME             = 'application.log'
    LOG_LEVEL                = DEBUG                # DEBUG, INFO, WARNING, ERROR, CRITICAL

    
    #
    # MariaDB configuration
    #
    MYSQL_DATABASE_HOST      = 'localhost'
    MYSQL_DATABASE_PORT      = 3306
    MYSQL_DATABASE_USER      = 'pmapi'
    MYSQL_DATABASE_PASSWORD  = 'pmapi'
    MYSQL_DATABASE_DB        = 'pmapi'
    MYSQL_DATABASE_CHARSET   = 'utf8'       # PyMySQL requires 'utf8', most others want 'utf-8'
    
    #
    # SQLite3 configuration
    #
    SQLITE3_DATABASE_FILE   = 'pmapi.sqlite3'
    
    #
    # Flask email
    #
    
    
    # EOF

Change database credentials to match your system credentials.
